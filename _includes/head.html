{% include base_path %}

<meta charset="utf-8">

{% include seo.html %}

<link href="{% if site.atom_feed.path %}{{ site.atom_feed.path }}{% else %}{{ base_path }}/feed.xml{% endif %}" type="application/atom+xml" rel="alternate" title="{{ site.title }} Feed">

<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="{{ base_path }}/assets/css/main.css">

<meta http-equiv="cleartype" content="on">

<!-- Simple Dark Mode Toggle -->
<style>
  .theme-toggle {
    position: fixed !important;
    top: 20px !important;
    right: 20px !important;
    z-index: 99999 !important;
    background: #ff6b6b !important;
    color: white !important;
    border: 3px solid #fff !important;
    border-radius: 50% !important;
    width: 60px !important;
    height: 60px !important;
    cursor: pointer !important;
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
    font-size: 24px !important;
    transition: all 0.3s ease !important;
    box-shadow: 0 4px 20px rgba(0,0,0,0.4) !important;
    font-family: Arial, sans-serif !important;
  }
  
  .theme-toggle:hover {
    background: #ff5252 !important;
    transform: scale(1.1) !important;
    box-shadow: 0 6px 25px rgba(0,0,0,0.5) !important;
  }
  
  [data-theme="dark"] .theme-toggle {
    background: #4ecdc4 !important;
    border-color: #2c3e50 !important;
  }
  
  [data-theme="dark"] .theme-toggle:hover {
    background: #45b7aa !important;
  }
  
  /* Fallback positioning if fixed doesn't work */
  @media (max-width: 768px) {
    .theme-toggle {
      position: absolute !important;
      top: 10px !important;
      right: 10px !important;
    }
  }
</style>

<script>
  // Immediate execution to ensure button appears
  (function() {
    console.log('Dark mode script starting...');
    
    function createThemeToggle() {
      // Remove existing button if any
      const existingButton = document.querySelector('.theme-toggle');
      if (existingButton) {
        existingButton.remove();
      }
      
      // Set initial theme
      const savedTheme = localStorage.getItem('theme') || 'light';
      document.documentElement.setAttribute('data-theme', savedTheme);
      console.log('Initial theme set to:', savedTheme);
      
      // Create toggle button
      const button = document.createElement('button');
      button.className = 'theme-toggle';
      button.innerHTML = savedTheme === 'light' ? 'üåô' : '‚òÄÔ∏è';
      button.title = savedTheme === 'light' ? 'Switch to dark mode' : 'Switch to light mode';
      button.setAttribute('aria-label', 'Toggle dark mode');
      
      // Add click handler
      button.addEventListener('click', function() {
        const html = document.documentElement;
        const currentTheme = html.getAttribute('data-theme');
        const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
        
        console.log('Switching theme from', currentTheme, 'to', newTheme);
        
        html.setAttribute('data-theme', newTheme);
        localStorage.setItem('theme', newTheme);
        
        // Update button icon
        button.innerHTML = newTheme === 'light' ? 'üåô' : '‚òÄÔ∏è';
        button.title = newTheme === 'light' ? 'Switch to dark mode' : 'Switch to light mode';
      });
      
      // Add button to page
      document.body.appendChild(button);
      console.log('Dark mode toggle button created and added to page');
      
      // Force button to be visible
      button.style.display = 'flex';
      button.style.visibility = 'visible';
      button.style.opacity = '1';
    }
    
    // Try to create button immediately
    if (document.body) {
      createThemeToggle();
    } else {
      // Wait for body to be available
      document.addEventListener('DOMContentLoaded', createThemeToggle);
    }
    
    // Also try after a short delay as backup
    setTimeout(createThemeToggle, 1000);
  })();
</script>